<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Export Taxonomy</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      max-width: 900px;
      margin: 40px auto;
      padding: 20px;
      background: #1a1a1a;
      color: #fff;
    }
    button {
      background: #4147FF;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      margin: 10px 5px;
    }
    button:hover { background: #3338dd; }
    textarea {
      width: 100%;
      height: 400px;
      background: #2a2a2a;
      color: #fff;
      border: 1px solid #444;
      border-radius: 8px;
      padding: 15px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      margin-top: 20px;
    }
    .info { color: #4147FF; }
    .success { color: #68B757; }
  </style>
</head>
<body>
  <h1>Export Your Good Taxonomy</h1>
  <p class="info">USE THIS IN THE CHROME WINDOW THAT HAS ALL YOUR KEYWORDS!</p>

  <button onclick="exportTaxonomy()">1. Export Taxonomy (Click Here First)</button>
  <button onclick="copyToClipboard()">2. Copy JSON to Clipboard</button>
  <button onclick="downloadJSON()">3. Download as File</button>

  <textarea id="output" placeholder="Click 'Export Taxonomy' button above..."></textarea>

  <div style="margin-top: 20px; padding: 15px; background: #2a2a2a; border-radius: 8px;">
    <h3 style="margin-top: 0;">Instructions:</h3>
    <ol style="line-height: 1.8;">
      <li>In the Chrome window with all your keywords, open this file: <code>export-taxonomy.html</code></li>
      <li>Click "1. Export Taxonomy" - you'll see the JSON appear in the box below</li>
      <li>Click "2. Copy to Clipboard" OR "3. Download as File"</li>
      <li>Then we'll import it into your new Meta Tagger!</li>
    </ol>
  </div>

  <script>
    function exportTaxonomy() {
      try {
        const taxonomy = localStorage.getItem('tagger_taxonomy');
        if (!taxonomy) {
          alert('No taxonomy found in localStorage!');
          return;
        }

        const parsed = JSON.parse(taxonomy);
        const pretty = JSON.stringify(parsed, null, 2);

        document.getElementById('output').value = pretty;

        // Count keywords
        const keywordCount = JSON.stringify(parsed).split('"').length;
        alert(`✓ Exported taxonomy with ~${Math.floor(keywordCount/2)} items!\n\nNow click "Copy to Clipboard" or "Download as File"`);
      } catch (e) {
        alert('Error exporting taxonomy: ' + e.message);
      }
    }

    function copyToClipboard() {
      const textarea = document.getElementById('output');
      if (!textarea.value) {
        alert('Click "Export Taxonomy" first!');
        return;
      }

      textarea.select();
      document.execCommand('copy');
      alert('✓ Copied to clipboard!\n\nNow paste this into the import tool in your new Meta Tagger window.');
    }

    function downloadJSON() {
      const textarea = document.getElementById('output');
      if (!textarea.value) {
        alert('Click "Export Taxonomy" first!');
        return;
      }

      const blob = new Blob([textarea.value], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'taxonomy-backup-' + Date.now() + '.json';
      a.click();
      URL.revokeObjectURL(url);

      alert('✓ Downloaded taxonomy backup file!');
    }
  </script>
</body>
</html>
